!function(){"use strict";class t{constructor(t,e){this.#t(t,e)}#t(t,e){this.name=t,this.description=e,this.id=null,this.status=!1,this._currentDate=new Date,this._day=this._currentDate.getDate()<10?"0"+this._currentDate.getDate():this._currentDate.getDate(),this._month=this._currentDate.getMonth()<10?"0"+(this._currentDate.getMonth()+1):this._currentDate.getMonth()+1,this._year=this._currentDate.getFullYear(),this._hour=this._currentDate.getHours()<10?"0"+this._currentDate.getHours():this._currentDate.getHours(),this._minute=this._currentDate.getMinutes()<10?"0"+this._currentDate.getMinutes():this._currentDate.getMinutes(),this.created=`${this._day}.${this._month}.${this._year} ${this._hour}:${this._minute}`,this._element={name:this.name,description:this.description,id:this.id,status:this.status,created:this.created}}get element(){return this._element}}class e{constructor(t){this.#e(t)}#e(t){const e=document.createElement("div");e.classList.add("errorContainer");const s=document.createElement("span");s.classList.add("errorSpan"),s.textContent=t,e.append(s),this._element=e}get element(){return this._element}}new class{constructor(){this.tickets=[],this.port=8080,this.actualTicket,this.#s(),this.#i(),this.#n(),this.#c()}#s(){document.querySelector(".field_addBtn").addEventListener("click",(()=>{document.querySelector(".popup_add").style.display="flex"}))}#c(){fetch(`http://localhost:${this.port}/?method=allTickets`).then((t=>{if(t.ok&&204!==t.status)return t.json();throw new Error("Response is not Ok or status is 204")})).then((t=>{this.tickets=t})).then((()=>{this.tickets.length>0&&this.#o()})).catch((t=>{console.log(t)}))}#a(t){const e=t.querySelector(".ticket_progressBtn"),s=t.querySelector(".ticket_editBtn"),i=t.querySelector(".ticket_deleteBtn");t.addEventListener("click",(n=>{this.actualTicket=t;const c=this.tickets.find((t=>t.id===this.actualTicket.id));switch(n.target){case e:const n=JSON.stringify({status:!c.status});fetch(`http://localhost:${this.port}/?method=updateById&id=${this.actualTicket.id}`,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:n}).then((t=>{if(t.ok&&204!==t.status)return t.json();throw new Error("Response is not Ok or status is 204")})).then((t=>{this.tickets.forEach((e=>{e.id===t.id&&(e.status=t.status)}))})).then((()=>{this.actualTicket=void 0,this.tickets.length>0&&this.#o()})).catch((t=>{console.log(t)}));break;case s:const o=t.querySelector(".ticket_Name").textContent,a=document.querySelector(".popup_edit");a.style.display="flex",fetch(`http://localhost:${this.port}/?method=ticketById&id=${this.actualTicket.id}`).then((t=>{if(t.ok&&204!==t.status)return t.json();throw new Error("Response is not Ok or status is 204")})).then((t=>{const{description:e}=t;return e})).then((t=>{t&&(a.querySelector(".popup_input").value=o,a.querySelector(".popup_textarea").value=t)})).catch((t=>{console.log(t)}));break;case i:document.querySelector(".popup_delete").style.display="flex";break;default:fetch(`http://localhost:${this.port}/?method=ticketById&id=${this.actualTicket.id}`).then((t=>{if(t.ok&&204!==t.status)return t.json();throw new Error("Response is not Ok or status is 204")})).then((t=>{const{description:e}=t;return e})).then((t=>{console.log(t);const e=this.actualTicket.querySelector(".ticket_Description");""===e.textContent?t.forEach((t=>{const s=document.createElement("p");s.textContent=t,e.append(s)})):e.textContent=""})).catch((t=>{console.log(t)}))}})),e.addEventListener("click",(e=>{this.actualTicket=t;const s=this.tickets.find((t=>t.id===this.actualTicket.id)),i=JSON.stringify({status:!s.status});fetch(`http://localhost:${this.port}/?method=updateById&id=${this.actualTicket.id}`,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:i}).then((t=>{if(t.ok&&204!==t.status)return t.json();throw new Error("Response is not Ok or status is 204")})).then((t=>{this.tickets.forEach((e=>{e.id===t.id&&(e.status=t.status)}))})).then((()=>{this.actualTicket=void 0,this.tickets.length>0&&this.#o()})).catch((t=>{console.log(t)}))})),s.addEventListener("click",(e=>{this.actualTicket=t;const s=t.querySelector(".ticket_Name").textContent,i=document.querySelector(".popup_edit");i.style.display="flex",fetch(`http://localhost:${this.port}/?method=ticketById&id=${this.actualTicket.id}`).then((t=>{if(t.ok&&204!==t.status)return t.json();throw new Error("Response is not Ok or status is 204")})).then((t=>{const{description:e}=t;return e})).then((t=>{t&&(i.querySelector(".popup_input").value=s,i.querySelector(".popup_textarea").value=t)})).catch((t=>{console.log(t)}))})),i.addEventListener("click",(e=>{this.actualTicket=t,document.querySelector(".popup_delete").style.display="flex"}))}#o(){document.querySelector(".field_ticketsContainer").innerHTML="",this.tickets.forEach((t=>{const e=document.createElement("div");e.classList.add("ticket"),e.setAttribute("id",t.id);const s=document.createElement("div");s.classList.add("ticket_body");const i=document.createElement("div");i.classList.add("ticket_progressBtn"),i.classList.add("ticket_icon"),i.classList.add("btn"),t.status&&i.classList.add("ticket_progressBtn-active");const n=document.createElement("div");n.classList.add("ticket_nameAndDateContainer");const c=document.createElement("span");c.classList.add("ticket_Name"),c.textContent=t.name;const o=document.createElement("span");o.classList.add("ticket_Description");const a=document.createElement("span");a.classList.add("ticket_created"),a.textContent=t.created,n.append(c,a);const r=document.createElement("div");r.classList.add("ticket_editBtn"),r.classList.add("ticket_icon"),r.classList.add("btn");const d=document.createElement("div");d.classList.add("ticket_deleteBtn"),d.classList.add("ticket_icon"),d.classList.add("btn"),s.append(i,n,r,d),e.append(s,o),document.querySelector(".field_ticketsContainer").append(e),this.#a(e)}))}#i(){document.querySelector(".field").addEventListener("submit",(s=>{if(s.preventDefault(),s.target.closest(".popup").classList.contains("popup_add")){const i=Array.from(s.target.closest(".form").elements).filter((({name:t})=>t)),n=new t(i[0].value,i[1].value),c=JSON.stringify(n.element);fetch(`http://localhost:${this.port}/?method=createTicket`,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:c}).then((t=>{if(t.ok&&204!==t.status)return t.json();throw new Error("Response is not Ok or status is 204")})).then((t=>{if(t.error)throw new Error(t.error);this.tickets.push(t)})).then((()=>{i[0].value="",i[1].value="",s.target.closest(".popup").style.display="none",this.tickets.length>0&&this.#o()})).catch((t=>{if("Ticket already exists"==t.message){const i=new e(t);s.target.closest(".popup").append(i.element),setTimeout((()=>{i.element.remove()}),3500)}console.log(t)}))}else if(s.target.closest(".popup").classList.contains("popup_edit")){this.tickets.find((t=>t.id===this.actualTicket.id)).status;const t=Array.from(s.target.closest(".form").elements).filter((({name:t})=>t)),i=JSON.stringify({name:t[0].value,description:t[1].value});fetch(`http://localhost:${this.port}/?method=updateById&id=${this.actualTicket.id}`,{method:"POST",headers:{"Content-type":"application/json;charset=utf-8"},body:i}).then((t=>{if(t.ok&&204!==t.status)return t.json();throw new Error("Response is not Ok or status is 204")})).then((t=>{if(t.error)throw new Error(t.error);this.tickets.forEach((e=>{e.id===t.id&&(e.name=t.name,e.description=t.description)}))})).then((()=>{this.actualTicket=void 0,s.target.closest(".popup").style.display="none",this.tickets.length>0&&this.#o()})).catch((t=>{if("Ticket already exists"==t.message){const i=new e(t);s.target.closest(".popup").append(i.element),setTimeout((()=>{i.element.remove()}),3500)}console.log(t)}))}s.target.closest(".popup").classList.contains("popup_delete")&&fetch(`http://localhost:${this.port}/?method=deleteById&id=${this.actualTicket.id}`).then((t=>{if(t.ok&&204!==t.status)return t.json();throw new Error("Response is not Ok or status is 204")})).then((t=>{this.tickets=t})).then((()=>{this.actualTicket=void 0,s.target.closest(".popup").style.display="none",this.#o()})).catch((t=>{console.log(t)}))}))}#n(){[...document.querySelectorAll(".popup_cancelBtn")].forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault(),t.target.parentNode.parentNode.parentNode.style.display="none"}))}))}}}();
//# sourceMappingURL=main.js.map